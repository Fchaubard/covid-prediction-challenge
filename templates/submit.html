<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta content="initial-scale=1, shrink-to-fit=no, width=device-width" name="viewport">
  <title>COVID-19 Prediction Challenge</title>
  <link rel="icon" type="image/png" href="/static/images/favicon.ico" />
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i|Roboto+Mono:300,400,700|Roboto+Slab:300,400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link href="  https://pagination.js.org/dist/2.0.7/pagination.css" rel="stylesheet">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-124148774-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-124148774-3');
  </script>

<style>
  a {color:#FF8484 }
  .primary-bg{
    background-color:rgb(53, 35, 74)
    }
  .header{
    background-color: #D84C73; 
    display: flex;
    align-items: center;
    justify-content: center;
    }
  .row{
    margin:0
    }
  .column{
    flex-direction:column
    }
.pagination li {
  padding:5px;
  margin: 3px;
}
.pagination{
  display: flex;
  align-items: center;
  justify-content: center;
}
  </style>
</head>

<!-- Navbar -->
<section>
  <nav class="navbar navbar-expand-lg navbar-dark primary-bg">
    <a class="navbar-brand" style="width:150px" href="#">
      <img class="w-100" style="padding:10px" src="static/images/logo_light.png">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item ">
          <a class="nav-link" href="/">Predictions</a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="/submit">Submit a Prediction</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/about">About</a>
        </li>
      </ul>
    </div>
  </nav>
  </section>
<!-- Navbar End -->

<!-- Body -->
<body>


<h3> Submitting a predictions.csv: </h3>
<ol>
<li>Please look at <a href="./data/all_data.csv"> all_data.csv (populated nightly)</a> for the full truth file we will use to match columns and rows to.</li>
<li> The dates must be in YYYY-MM-DD format and be in order. </li>
<li> The countries, states, and counties should all be titled the same as the <a href="./data/all_data.csv"> all_data.csv</a> file as discussed above.</li>
<li> Please title your submission file predictions.csv.</li>
<li> Please include your source code so others can leverage your experience.</li>
<li>***"Georgia" could mean the country or the state. We could have used country codes, etc, but we wanted to make submitting easy, so just use "Georgia_State" to refer to the state and "Georgia" for the country. This is the only change we make to the raw data pulled from NYT and JHU before scoring.</li>
</ol>

<h3> What is this doing that is not being done on Kaggle? </h3>
As mentioned, there are 2 Kaggle competitions for this. The reasons (listed below) prompted us to launch this project to be disparate from the Kaggle format:
<ol>
<li> This is a rolling evaluation vs. a strict start / end date which allows constant submitting throughout the crisis vs. a "date" when the competition stops. All people should be able to submit all the time to allow for as many predictions as possible with maximum amount of information. As priors change, all submitters can easily update the predictions and that can be used to update the public on the implications of that domain shift quickly.</li>
<li> The point of predicting how long this is going to last, how many people will die, in each country, state and county, etc, is NOT to win a competition, but to inform and warn the public as quickly as possible to act accordingly. The results of the predictions in Kaggle are remarkably useless. There is not interactive chart to go through each, especially the good ones, and use the prediction to make decisions. If the prediction does not change someone's behavior, it is useless. </li>
<li> The predictions must be comprehensive. All predictions on the web should be compared to ensure the best one is easily shown. They should include predictions from medical journals, the CDC, the WHO, and the AI community. Kaggle is not acitvely scraping predictions off the web to add to the page, we are.</li>
<li> People care most about what is going to happen and when in their local community. The predictions should therefore be against all local municipalities as well. Country, State, Counties, etc. The Kaggle competition is evaluating on a strict subset of this.</li>
</ol>


<h1 id="getting_started">Getting started</h1>
Getting started is very easy. We provide a starter <a href="https://github.com/Fchaubard/covid-prediction-challenge/blob/master/templates/ipython/predict%20covid-19.ipynb">ipython notebook</a> that will download all the most recent data and create a naïve predictions.csv that you can drag and drop into the submit form. This is only a helper script and not required to be used at all. 
A predictions.csv must initially include the following columns: date (YYYY-MM-DD) starting a week after submission date (all previous dates/rows will be ignored anyway), # of people infected globally, and death rate globally. Then later if people are using this, we can add country level predictions, and age level predictions. We will report scores for all submissions above a certain accuracy. 

In the submit prediction form, you can submit the csv, name of submitter, and optionally add a github link / ipython nb. 

<h1 id="submissions">Submissions</h1>

<!-- TODO: PREVENT DOUBLE CLICKS! -->

<!-- <form enctype="multipart/form-data" method="post" action="{{ url_for('submit_form') }}" name="form_submit"> -->
<div id="formdiv">
<form enctype="multipart/form-data" method="post" name="form_submit"> 
  <div class="form-group"> <!-- name/email -->
    <label for="email">Email address</label>
    <input type="email" name="email" class="form-control" id="email" aria-describedby="emailHelp" placeholder="Enter email" required>
  </div>

  <div class="form-group"> <!-- source -->
    <label for="source">Source Code / Repo / Website / etc</label>
    <input class="form-control" name="source" id="source" placeholder="https://github.com/..." required>
  </div>
  <div class="form-group"> <!-- predictions.csv -->
    <label for="file">Example file input</label>
    <input type="file" class="form-control-file" id="file" name="file" required>
  </div>
  <button type="submit" id="submitt" class="btn btn-primary">Submit</button>
</form>
<div id="failed_submit">
</div>
</div>

<script>
  var form = document.forms.namedItem("form_submit");
  form.addEventListener('submit', function(ev) {

      var oOutput = document.querySelector("formdiv"),
          oData = new FormData(form);

      var oReq = new XMLHttpRequest();
      oReq.open("POST", "{{url_for('submit_form')}}", true);
      oReq.onload = function(oEvent) {
        console.log("here",oReq.response)
        console.log("here",oReq.responseText)
        if (oReq.status == 200) {
          if (oReq.responseText=="OK"){
            document.getElementById("formdiv").innerHTML = "Success! Thank you for contributing to the project! Your submission will begin posting results in 7 days."
          } else {
            document.getElementById("failed_submit").innerHTML = "Failed! Please try again. Reason:" + oReq.responseText
         
          }
        } else {
          document.getElementById("failed_submit").innerHTML = "Error " + oReq.status + " occurred when trying to upload your file.<br \/>";
        }
      };

      oReq.send(oData);
      ev.preventDefault();
    }, 
    false);
</script>




<h1>Contributing to the Core Project</h1>
If you would like to help on this project or you have any questions, please send a note to fchaubard [[at]] gmail.com. 
</div>
</div>



<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
<script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
<script src="https://pagination.js.org/dist/2.1.5/pagination.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>


